---
title: "Распространенные уязвимости в системах безопасности блокчейн-мостов"
description: "Одни из распространенных уязвимостей в системах безопасности блокчейн-мостов включают слабую ончейн-валидацию и неправильную конфигурацию, которые могут представлять риски для безопасности и быть использованы злоумышленниками для атак и вывода средств. Недостаточная проверка при ончейн-валидации и ошибки в конфигурации могут создавать возможности для взлома и кражи активов из мостов."
level: "advanced"
coverImage: "/assets/blog/common-vulnerabilities-in-blockchain-bridge-security-systems/cover.png"
date: "2023-11-29T05:35:07.322Z"
time: 4
ogImage:
  url: "/assets/blog/common-vulnerabilities-in-blockchain-bridge-security-systems/cover.png"
tags:
  - blockchain
  - technology
  - security
---


## Введение
Блокчейн-мост - это протокол, который объединяет два блокчейна, обеспечивая возможность взаимодействия между ними. Например, если у вас есть биткоины, но вы хотите оперировать в DeFi-среде Ethereum, можно перемещать активы через мост, не прибегая к их продаже.

Эти протоколы играют ключевую роль в достижении совместимости в мире блокчейна. Они функционируют, проводя множество проверок ончейн и офчейн, что может повлечь за собой определенные риски в системе безопасности.

## Важность безопасности блокчейн-мостов 

Блокчейн-мосты, как правило, хранят токены, которые пользователи перемещают между разными блокчейнами. С ростом использования таких кроссчейн-переводов эти мосты, часто представленные в виде смарт-контрактов, накапливают большие объемы токенов, что делает их привлекательной целью для хакерских атак.

Блокчейн-мосты сами по себе содержат множество уязвимостей, поскольку состоят из различных компонентов. Злоумышленники могут намереваться атаковать эти кроссчейн-приложения с целью украсть средства из-за значительного объема активов, хранящихся в них.

По оценкам CertiK, в 2022 году из-за атак на блокчейн-мосты были утеряны более 1,3 миллиарда USD, что составляет 36% от общих потерь за год.

## Распространенные уязвимости в системах безопасности мостов

Для обеспечения надежности мостов важно изучать типичные слабые места и проводить тщательное тестирование перед их внедрением. Существует четыре основных категории уязвимостей, которые чаще всего подвергают мосты риску.

### Слабая ончейн-валидация
Валидация транзакций на обычных блокчейн-мостах, особенно тех, что привязаны к определенным DApp, ограничена. В этих мостах основные операции, такие как майнинг и перевод токенов, выполняются на централизованных серверах, в то время как проверки проводятся вне блокчейна.

Другие виды мостов используют смарт-контракты для подтверждения сообщений и ончейн-валидации. При вводе средств на чейн, смарт-контракт создает подписанное сообщение и добавляет его к транзакции. Это служит как подтверждение депозита и проверки запросов на вывод средств. Этот процесс должен защитить систему от атак, таких как повторное воспроизведение данных и подделка информации о депозитах.

Однако даже небольшая уязвимость в процессе ончейн-валидации может стать причиной серьезных атак. Например, если используется дерево Меркла для подтверждения транзакций, хакер может подделать эти доказательства, что дает ему возможность создать новые токены и отправить их на свой счет.

Некоторые мосты используют wrapped-токены: если транзакция не проходит проверку, злоумышленник может направить wrapped-токены с моста на свой адрес. Это происходит за счет необходимости одобрения жертвы на перевод средств через контракт моста и их вывод.

Кроме того, многие мосты требуют от пользователей DApp постоянного одобрения токенов для экономии на комиссиях. Это повышает риски, так как смарт-контракты получают доступ к большому количеству токенов в кошельке пользователя, что может быть использовано злоумышленниками для кражи активов.


### Слабая офчейн-валидация
Системы некоторых блокчейн-мостов проводят проверку отправленных сообщений из блокчейна при помощи внутреннего офчейн-сервера. Особенно важной является проверка транзакций с депозитами.

Блокчейн-мосты с офчейн-валидацией функционируют таким образом:

1. Пользователи используют DApp для депонирования токенов в смарт-контракт на исходном чейне.

2. DApp отправляет хеш транзакции с депозитом на внутренний сервер через API.

3. Внутренний сервер проверяет полученный хеш несколько раз. Если подпись признана подлинной, сервер добавляет подпись к сообщению и возвращает его в пользовательский интерфейс через API.

4. DApp проверяет полученную подпись и разрешает пользователю выводить свои токены из целевого чейна.

Роль внутреннего сервера заключается в проверке подлинности транзакции с депозитом и ее подписи, чтобы предотвратить возможные атаки и риски для пользователей. Однако недостаточная проверка структуры транзакции или адреса контракта, инициировавшего операцию, может привести к возможности хакерской атаки и похищения токенов из целевого чейна.

### Плохое управление нативными-токенами
Управление нативными и утилитарными токенами на блокчейн-мостах различается. Например, ETH является нативным токеном Ethereum, в то время как большинство утилитарных токенов создаются на базе стандарта ERC-20.

Перевод ETH в другой чейн требует внесения в контракт моста через привязку ETH к транзакции, проверка количества отправленного ETH происходит в поле «msg.value».

Депонирование токенов ERC-20 сопровождается процедурой, где перед внесением токенов пользователь дает разрешение контракту моста на их использование. Эти действия, включая сжигание или перевод токенов, могут выполняться в рамках одной функции или через создание отдельных функций. Попытка внести ETH через функцию депонирования ERC-20 может привести к потере средств.

При обработке запросов на ввод средств через ERC-20 пользователи предоставляют адрес токена, что может создать риски при выполнении транзакций с ненадежных адресов. Использование белого списка для одобренных токенов может снизить этот риск, фильтруя только одобренные адреса для совершения операций.

Проблемы могут возникнуть при обработке кроссчейн-перевода нативных токенов, так как они не имеют адресов. Этот аспект может обойти проверку на присутствие в белом списке, если быть реализованным неправильно. Такой неправильный запрос может позволить злоумышленнику выполнить транзакцию без передачи токенов через контракт.

### Неправильная конфигурация
Недостатки в настройке являются основным звеном большинства блокчейн-мостов, включая составление списков токенов и адресов, назначение подписывающих лиц и другие важные конфигурационные задачи. Точная настройка всех параметров играет критическую роль, поскольку даже небольшие ошибки могут привести к серьезным финансовым убыткам.

В прошлом в индустрии блокчейна случалось, что из-за неправильной конфигурации злоумышленники успешно обходили проверки при передаче активов. В одном случае, всего за несколько дней до инцидента, команда проекта внесла изменения в протокол, связанные с переменной, отвечающей за стандартные значения одобренных сообщений. Это изменение привело к тому, что все сообщения автоматически рассматривались как проверенные, что злоумышленникам позволило отправить фальшивое сообщение и обойти проверку.

## Усиление безопасности мостов
Четыре основные уязвимости, описанные ранее, выявляют слабые места в безопасности блокчейн-мостов и связанных с ними экосистемах. Нет универсального решения для всех этих проблем: каждая уязвимость требует индивидуального подхода.

Предоставить единые рекомендации по устранению ошибок в процессе проверки достаточно сложно, так как каждый мост имеет уникальные требования. Однако основной совет — проводить тщательное тестирование мостов на наличие уязвимостей и обеспечивать надежность процесса проверки.

В конечном счете, необходимо уделять особое внимание тщательной проверке на возможные угрозы и акцентировать внимание на наиболее распространенных уязвимостях в системах безопасности блокчейн-мостов.

## Заключение
Кроссчейн-мосты представляют значительное хранилище активов, что делает их привлекательной целью для хакеров и злоумышленников. Для защиты от возможных атак разработчики должны строго проверять безопасность своих мостов еще до их запуска, а также привлекать внешние аудиторские организации для обеспечения защиты от возможных взломов и атак. Мосты играют ключевую роль в блокчейн-пространстве, и обеспечение их безопасности должно быть важнейшим приоритетом на всех этапах разработки и создания инфраструктуры Web3.

